{"version":3,"sources":["utils/axios.js","utils/index.js","scripts/mobx/detail.js","scripts/view/detail/index.js"],"names":["baseURL","axios","defaults","token","fail","msg","Toast","hide","success","showToast","text","info","getTele","tele","sessionStorage","toString","split","splice","join","headers","common","post","interceptors","request","use","config","time","loading","console","log","error","offline","Promise","reject","response","data","type","createHashHistory","this","flag","sendFlag","observable","action","id","a","async","pID","res","result","comments","pid","commentList","Detail","connect","observer","send","search","URLSearchParams","get","value","detail","getComment","props","location","getInfo","arr","updateEP","i","parseInt","slice","push","key","className","onClick","history","go","pics","src","lowResolutionH","alt","size","icon","style","fontSize","fontWeight","name","changeFlag","color","score","displayName","second","first","map","item","length","pic","replace","content","replay","index","changeSendFlag","ref","el","autoFocus","placeholder","Component"],"mappings":"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","file":"static/js/12.2af63265.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport { Toast } from \"antd-mobile\"\r\nimport { history } from \"&\"\r\n\r\n// const baseURL = 'http://192.168.50.132:1232/';\r\nconst baseURL = 'http://123.57.6.111:1232/'; //公网\r\n\r\naxios.defaults.baseURL = baseURL;\r\n\r\nlet token = \"\";\r\naxios.defaults.headers.common[\"token\"] = token;//req.headers.token取\r\naxios.defaults.headers.post[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\r\n\r\nfunction loadingToast(msg, time) {\r\n    msg = msg || \"请求中\";\r\n    time = time || 1;\r\n    Toast.hide();\r\n    Toast.loading(msg, time, () => {\r\n        console.log('Load complete !!!');\r\n    });\r\n}\r\nexport function fail(msg) {\r\n    Toast.hide();\r\n    Toast.fail(msg, 1);\r\n}\r\n\r\nexport function offline(msg) {\r\n    Toast.hide();\r\n    Toast.offline(msg, 1);\r\n}\r\n\r\nexport function success(msg) {\r\n    Toast.hide()\r\n    Toast.success(msg, 1);\r\n}\r\n\r\n//axios拦截器 Interceptors\r\n//request 请求发送之前的拦截器\r\naxios.interceptors.request.use(function (config) {\r\n    //配置动画\r\n    loadingToast();\r\n    token = sessionStorage.token ? sessionStorage.token : \"\";\r\n    config.headers[\"token\"] = token;\r\n    return config;\r\n}, function (error) {\r\n    //请求错误提示\r\n    offline(\"请求失败,网络异常\")\r\n    return Promise.reject(error);\r\n})\r\n\r\n//response 响应完成拦截器\r\naxios.interceptors.response.use(function (response) {\r\n    // console.log(response)\r\n    // if (response.data.code === \"3000\") {\r\n    //     history.push(\"/login\")\r\n    // }\r\n    // type  不存在    success\r\n    // type = 0  fail\r\n    // type = 1  success \r\n    if (!!response.data.type) {\r\n        success(response.data.msg);\r\n    } else {\r\n        if (response.data.type === 0) {\r\n            fail(response.data.msg)\r\n        } else {\r\n            success(response.data.msg)\r\n        }\r\n    }\r\n    // 成功的响应\r\n    return response;\r\n}, function (error) {\r\n    // 失败的响应 \r\n    fail(\"响应失败-服务器异常\")\r\n    return Promise.reject(error);\r\n})\r\n\r\n\r\nexport { axios, baseURL }","import { Toast } from \"antd-mobile\"\r\nimport { createHashHistory } from \"history\"\r\n\r\n\r\nexport { axios, baseURL } from \"./axios\"\r\n\r\nexport function showToast(text) {\r\n    Toast.info(text, 1);\r\n}\r\n\r\nexport function getTele(tele) {\r\n    tele = sessionStorage.tele.toString();\r\n    tele = tele.split(\"\")\r\n    tele.splice(3, 4, \"****\").join(\"\")\r\n    return tele\r\n}\r\n\r\nexport function getTime(time){\r\n    let date=new Date(time)\r\n    let year=date.getFullYear();\r\n    let month=date.getMonth()+1;\r\n    month=month>9?month:\"0\"+month;\r\n    let day=date.getDate();\r\n    day=day>9?day:\"0\"+day;\r\n    return `${year}-${month}-${day}`\r\n}\r\n\r\nexport const history = new createHashHistory()","import { observable, action, computed, autorun } from \"mobx\"\r\nimport { axios ,showToast} from \"&\"\r\n\r\nclass Detail {\r\n\r\n    @observable info={}\r\n\r\n    @action getInfo = async (id)=>{\r\n        const res= await axios.post(\"/react/detail\",{pID:id})\r\n        console.log(res.data.result)\r\n        this.info= res.data.result\r\n    }\r\n\r\n    @observable flag=false;\r\n    @action changeFlag(){\r\n        this.flag=!this.flag\r\n    }\r\n\r\n    @observable sendFlag=false;\r\n    @action changeSendFlag(flag){\r\n        this.sendFlag=flag\r\n    }\r\n\r\n    @observable comments=[];\r\n    @action getComment=async ({comments,pid})=>{\r\n        console.log(comments,pid)\r\n        if(comments){\r\n            const res=await axios.post(\"/react/comments\",{comments,pid});\r\n            this.commentList(pid);\r\n        }else{\r\n            showToast(\"请输入评论内容!\")\r\n        }\r\n    }\r\n    @action commentList=async (pid)=>{\r\n        const res=await axios.post(\"/react/getComment\",{pid});\r\n        this.comments=res.data.result\r\n    }\r\n\r\n}\r\n\r\nexport default new Detail()","import \"./index.scss\";\r\nimport React, { Component } from \"react\"\r\nimport { connect } from \"react-redux\";\r\nimport { observer } from \"mobx-react\";\r\nimport detail from \"~/mobx/detail\"\r\nimport { WingBlank, Button, WhiteSpace } from \"antd-mobile\";\r\nimport { baseURL, getTele } from \"&\"\r\n@connect()\r\n@observer\r\nclass Detail extends Component {\r\n    componentDidMount() {\r\n        let id = new URLSearchParams(this.props.location.search).get(\"pid\")\r\n        detail.getInfo(id)\r\n        detail.commentList(id)\r\n    }\r\n    send = (search) => {\r\n        console.log(search)\r\n        let pid = new URLSearchParams(search).get(\"pid\");\r\n        let comments = this.comments.value\r\n        detail.getComment({ comments, pid });\r\n    }\r\n    render() {\r\n        const {\r\n            info\r\n        } = detail\r\n        let arr = [];\r\n        if (info.updateEP) {\r\n            for (let i = 0; i < parseInt(info.updateEP.slice(3)); i++) {\r\n                arr.push(<li key={i}>{i + 1}</li>)\r\n            }\r\n        }\r\n        return (\r\n            <div className=\"detail\">\r\n                <div className=\"pic\">\r\n                    <div className=\"back\" onClick={() => this.props.history.go(-1)}> {\"< 返回\"} </div>\r\n                    {info.pics && <img src={detail.info.pics.lowResolutionH} alt=\"\" />}\r\n                </div>\r\n                <WingBlank size=\"md\" className=\"content\">\r\n                    <Button icon={<img src=\"http://m.miguvideo.com/mgs/msite/prd/v_20191231184517_1ef395e6/dist/assets/MiGuVideoIcon.png\" alt=\"\" />} type=\"primary\" size=\"small\">打开咪咕视频,体验5G超高清!</Button>\r\n                    <h2 className=\"title\">\r\n                        <span style={{ fontSize: \"18px\", fontWeight: 900 }}>{info.name}</span>\r\n                        {!detail.flag && <span className=\"jj iconfont\" onClick={() => detail.changeFlag()}>简介 ></span>}\r\n                        {detail.flag && <span className=\"iconfont jj\" onClick={() => detail.changeFlag()}> &#xe652; </span>}\r\n                    </h2>\r\n                    <h2 className=\"body\">\r\n                        <span style={{ color: info.score ? \"red\" : \"inherit\" }}>{info.score ? info.score + \"分\" : \"暂无评分\"}</span>\r\n                        <span> / </span>\r\n                        {info.displayName && <span>{info.displayName.second ? info.displayName.second.join(\" \") : info.displayName.first}</span>}\r\n                        <span> / </span>\r\n                        <span>{info.updateEP ? info.updateEP : \"暂无剧集\"}</span>\r\n                    </h2>\r\n                    {\r\n                        detail.flag && <div className=\"more\">\r\n                            <WingBlank>\r\n                                <h2>简介</h2>\r\n                                <p>{info.detail}</p>\r\n                            </WingBlank>\r\n                            <WhiteSpace size=\"lg\" />\r\n                        </div>\r\n                    }\r\n                    <div className=\"section\">\r\n                        <div>\r\n                            <p>{info.updateEP ? \"剧集\" : \"暂无剧集\"}</p>\r\n                            <span>每周六至周一晚20点更新2集 ></span>\r\n                        </div>\r\n                        {info.updateEP && <div className=\"ji\">\r\n                            <ul>\r\n                                {arr.map(item => (\r\n                                    item\r\n                                ))}\r\n                            </ul>\r\n                        </div>}\r\n                    </div>\r\n                    <div className=\"talk\">\r\n                        <p>评论</p>\r\n                        {\r\n                            !detail.comments.length>0&&<div className=\"default\">\r\n                                <WhiteSpace/>\r\n                                <h2>暂无评论,赶紧来抢沙发吧!</h2>\r\n                            </div>\r\n                        }\r\n                        {detail.comments.map((item, i) => (\r\n                            <div className=\"each\" key={i}>\r\n                                <div className=\"head\">\r\n                                    <div className=\"img\">\r\n                                        <img src={item.pic ? item.pic.replace(/public/, baseURL) : \"http://img.cmvideo.cn:8080/publish/voms2/uic_service/picture/userImage/543/626/5181.jpg\"} alt=\"\" />\r\n                                    </div>\r\n                                    <div className=\"right\">\r\n                                        <div className=\"biaoti\">{getTele(item.tele)}</div>\r\n                                        <div className=\"neirong\">{item.content}</div>\r\n                                    </div>\r\n                                </div>\r\n                                {item.replay.length > 0 && <div className=\"re\">\r\n                                    {item.replay.map((content, index) => (\r\n                                        <div key={index}>\r\n                                            <WhiteSpace />\r\n                                            <p><span>{getTele(content.tele)} : </span>{content.msg}</p>\r\n                                            <WhiteSpace />\r\n                                        </div>\r\n                                    ))}\r\n\r\n                                </div>}\r\n                                <div className=\"bottom\">\r\n                                    <div className=\"time\">{item.time}</div>\r\n                                    <div className=\"opt\">\r\n                                        <div className=\"zan\">\r\n                                            <i className=\"iconfont\">&#xe503;</i>\r\n                                            <span>点赞</span>\r\n                                        </div>\r\n                                        <div className=\"hui\">\r\n                                            <i className=\"iconfont\">&#xe603;</i>\r\n                                            <span>回复</span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </WingBlank>\r\n                <div className=\"foot\">\r\n                    <div className=\"comment\" onClick={() => detail.changeSendFlag(true)}>\r\n                        <i className=\"iconfont\">&#xe778;</i>\r\n                        <div className=\"input\"> 不吐不快...</div>\r\n                    </div>\r\n                    <div className=\"sec\">\r\n                        <i className=\"iconfont\">&#xe603;</i>\r\n                        <p>307</p>\r\n                    </div>\r\n                    <div className=\"sec\">\r\n                        <i className=\"iconfont\">&#xe692;</i>\r\n                        <p>收藏</p>\r\n                    </div>\r\n                    <div className=\"sec\">\r\n                        <i className=\"iconfont\">&#xe604;</i>\r\n                        <p>缓存</p>\r\n                    </div>\r\n                    <div className=\"sec\">\r\n                        <i className=\"iconfont\">&#xe609;</i>\r\n                        <p>分享</p>\r\n                    </div>\r\n                    {detail.sendFlag && <div className=\"msg\">\r\n                        <div className=\"input\">\r\n                            <input ref={el => this.comments = el} autoFocus type=\"text\" placeholder=\"我来说两句\" />\r\n                        </div>\r\n                        <div className=\"send\">\r\n                            <span>300</span>\r\n                            <button className=\"fasong\" onClick={() => this.send(this.props.location.search)}>发送</button>\r\n                            <button className=\"cancel\" onClick={() => detail.changeSendFlag(false)}>取消</button>\r\n                        </div>\r\n                    </div>}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default Detail;"],"sourceRoot":""}